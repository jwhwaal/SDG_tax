ggplot(., aes(x=report, y=CASH_TAX_PAID, col = ctrygrp)) +
geom_boxplot()
#make a boxplot of scaled Cash ETR
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=CETR_scaled, col = ctrygrp)) +
geom_boxplot()
#make a boxplot of  Cash ETR_3 >0
df %>% filter(Year %in% c(2016,2020) & CETR_3 >0) %>%
ggplot(., aes(x=report, y=CETR_3, col = ctrygrp)) +
geom_boxplot()
#make a boxplot of  BTD
df %>% filter(Year %in% c(2016,2020) & CETR_3 >0) %>%
ggplot(., aes(x=report, y=BTD, col = ctrygrp)) +
geom_boxplot()
#make a boxplot of  SHELTER
df %>% filter(Year %in% c(2016,2020) & CETR_3 >0) %>%
ggplot(., aes(x=report, y=log(SHELTER), col = ctrygrp)) +
geom_boxplot()
#make a boxplot of pre_tax income
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=PRETAX_INCOME, col = ctrygrp)) +
geom_boxplot()
#Unpaired Wilcoxon
# Subset weight data before treatment
report <- subset(df,  report == 1, delta_scaled,
drop = TRUE)
# subset weight data after treatment
noreport <- subset(df,  report == 0, delta_scaled,
drop = TRUE)
wilcox.test(report, noreport, alternative = "less")
#Unpaired Wilcoxon
# Subset weight data before treatment
report1 <- subset(df,  report == 1, CASH_TAX_PAID,
drop = TRUE)
# subset weight data after treatment
noreport1 <- subset(df,  report == 0, CASH_TAX_PAID,
drop = TRUE)
wilcox.test(report1, noreport1, alternative = "less")
#make a boxplot of delta-scaled versus report
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=delta_scaled, col = ctrygrp)) +
geom_boxplot()
df %>% group_by(report, ctrygrp) %>%
summarize(mean = mean(delta_scaled, na.rm = TRUE))
unique(df$Sector)
#make a boxplot of BTD versus report
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=BTD, col = ctrygrp)) +
geom_boxplot()
df %>% group_by(report, ctrygrp) %>%
summarize(mean = mean(delta_scaled, na.rm = TRUE))
x <- df$BTD[df$report==1]
y <- df$BTD[df$report==0]
mean(x, na.rm = TRUE)
mean(y, na.rm = TRUE)
length(x)
# run a t-test on the means
t.test(x, y = NULL,
alternative = c("greater"),
mu = 0, paired = FALSE, var.equal = FALSE,
conf.level = 0.95)
#make a boxplot of BTD versus report
mean(as.numeric(df$report, na.rm=TRUE))
df %>% filter(Year ==2020) %>%
select(report, BTD, ctrygrp, sdg)
df %>% group_by(Year) %>%
select(report, BTD, ctrygrp, sdg) %>%
summarize(n = n())
data3 <- df %>%
mutate(sdg = ifelse(is.na(sdg), 0, sdg)) %>%
select(sdg, BTD, BTD_a, ctrygrp, Year, Sector, sdg01:sdg16, report, country, delta_scaled,
CETR_3, CETR_scaled, ROA, LEV, RDS, FOREIGN, SIZE, SHELTER )
data3 %>%
ggplot(., aes(x=BTD, y=sdg, col = ctrygrp)) +
geom_point()
df %>% group_by(s, ctrygrp) %>%
summarize(mean = mean(BTD, na.rm = TRUE))
# plot BTD versus CETR_3
data3 %>%
ggplot(., aes(x=BTD, y=CETR_3, col = ctrygrp)) +
geom_point()
r1 <- lm(data3, formula = BTD ~ sdg07 + sdg13 + sdg16 + ctrygrp)
summary(r1)
r2 <- glm(report ~ BTD + ROA + RDS + SIZE + LEV + ctrygrp, family = binomial, data = data3)
summary(r2)
summary(data3$BTD)
r3 <- lm(BTD_a ~ sdg02 +sdg03 + sdg07 + sdg08 + sdg13 + sdg16 + RDS + ROA + SIZE + LEV +
FOREIGN + ctrygrp, data = data3)
summary(r3)
data3 %>%
ggplot(., aes(x=BTD_a, y=ROA/100, col = Sector)) +
geom_point()
data3 %>% filter(CETR_3 >0) %>%
ggplot(., aes(x=CETR_3, y=ROA/100, col = Sector)) +
geom_point()
# fit some PLM models on BTD
library(plm)
fixed1 <- plm(CETR_3 ~ sdg03 + sdg07 +sdg13 , data=data3, index=c("Year"), model="within")
summary(fixed1)
data4 <- data3 %>% filter(as.integer(report)==1) %>% mutate(SDG = log(sdg03 + sdg08 + sdg13 + sdg16 +1))
fixed2 <- plm(SDG ~ BTD + SIZE + FOREIGN, data=data4, index=c("Year"), model="within")
summary(fixed2)
fixed3 <- plm(sdg03 ~ BTD + Sector + country , data=data4, index=c("Year"), model="within")
summary(fixed3)
fixed4 <- plm(BTD_a ~ log(sdg13+1) + RDS + SIZE + LEV + ROA +
FOREIGN + ctrygrp, data=data3, index=c("Year"), model="within")
summary(fixed4)
data4 %>% filter(CETR_scaled > -20 & CETR_scaled < 20) %>%
ggplot(., aes(x=BTD_a, y=report, col = Sector)) +
geom_boxplot() +
facet_grid(. ~ ctrygrp)
data3 %>% filter(CETR_3 > -10) %>%
ggplot(., aes(x=BTD_a, y=Sector)) +
geom_boxplot()
data3 %>% filter(CETR_3 > -10) %>%
ggplot(., aes(x=BTD_a, y=SIZE)) +
geom_point()
summary(data3)
data3 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=ROA, y=BTD_a, col = Sector)) +
geom_point()
data4 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=log(sdg13+1), y=CETR_scaled, col = Sector)) +
geom_point()
data4 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=ROA, y=CETR_scaled, col = Sector)) +
geom_point()
data4 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=ROA, y=BTD, col = Sector)) +
geom_point()
x <- df$BTD[df$report==1]
y <- df$BTD[df$report==0]
mean(x, na.rm = TRUE)
mean(y, na.rm = TRUE)
# run a t-test on the means
t.test(x, y = NULL,
alternative = c("greater"),
mu = 0, paired = FALSE, var.equal = FALSE,
conf.level = 0.95)
#make a boxplot of delta-scaled versus sector
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=delta_scaled, col = Sector)) +
geom_boxplot()
df %>% group_by(Sector, Year) %>%
summarize(mean_delta = mean(delta_scaled, na.rm=TRUE),
mean_ROA = mean(PRETAX_INCOME/ASSETS, na.rm =TRUE)) %>%
arrange(mean_delta) %>%
ggplot(aes(mean_ROA, mean_delta, col = Year)) +
geom_point()
#make a plot of sdg mentioning versus sector
# make a plot of delta scaled versus sdg mentioning frequency
df %>% filter(Year %in% c(2016,2020) & ctrygrp != "OTH") %>% ggplot(aes(Sector, log(sdg))) +
geom_boxplot() +
facet_grid(Year ~ ctrygrp) +
coord_flip()
#make a plot of sdg  versus sector
colors <- colorRampPalette(c("blue", "green", "yellow", "red"))(10)
df %>%  dplyr::select(Year, Sector, sdg01:sdg16, ctrygrp) %>%
filter(Year %in% c(2016,2020)) %>%
pivot_longer(cols = sdg01:sdg16,
names_to = "SDG",
values_to = "count") %>%
ggplot(aes(Sector, SDG)) +
geom_tile(aes(fill = log(count)), na.rm = TRUE) +
scale_fill_distiller(palette = "Spectral") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(axis.text.y=element_text(size=5)) +
coord_flip() +
facet_grid(ctrygrp ~ Year)
# make a plot of BTD versus sdg mentioning frequency
df %>% filter(Year %in% c(2016,2020) & ctrygrp != "OTH") %>% ggplot(aes(log(sdg+1), BTD, color = ctrygrp)) +
geom_point() +
facet_grid(. ~ Year)
df %>% filter(Year %in% c(2016,2020) & ctrygrp != "OTH") %>% ggplot(aes(report, BTD, col = ctrygrp)) +
geom_boxplot() +
facet_grid(. ~ Year)
df %>% filter(Year %in% c(2016,2020) & ctrygrp != "OTH") %>% ggplot(aes(BTD, log(sdg03+1), color = ctrygrp)) +
geom_point() +
facet_grid(. ~ Year)
#US environmentally sensitive industries, including oil and gas extraction, mining (except oil and gas), support activities for mining, utilities, food manufacturing, beverage and tobacco product manufacturing, paper manufacturing, petroleum and coal products manufacturing, chemical manufacturing, and fabricated metal product manufacturing.
# International Review of Accounting, Banking & Finance . Summer2012, Vol. 4 Issue 2, p61-99. 39p
#make a heatmap of BTD versus Sector and ctrygrp
df %>%  dplyr::select(Year, Sector, ctrygrp, BTD, sdg, report, gc, gri, int) %>%
filter(Year %in% c(2016,2020)) %>%
group_by(Sector, ctrygrp, report) %>% summarize(mBTD = mean(BTD, na.rm=TRUE), Year = Year, report = report) %>%
ggplot(aes(Sector, ctrygrp)) +
geom_tile(aes(fill = mBTD)) +
scale_fill_continuous(type = "viridis") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(axis.text.y=element_text(size=5)) +
coord_flip() +
facet_grid(report ~ Year)
r3 <- lm(BTD_a ~ sdg02 +sdg03 + sdg07 + sdg08 + sdg13 + sdg16 + RDS + ROA + SIZE + LEV +
FOREIGN + ctrygrp, data = data3)
summary(r3)
data3 %>%
ggplot(., aes(x=BTD_a, y=ROA/100, col = Sector)) +
geom_point()
data3 %>% filter(CETR_3 >0) %>%
ggplot(., aes(x=CETR_3, y=ROA/100, col = Sector)) +
geom_point()
fixed3 <- plm(sdg03 ~ BTD_a + Sector + country , data=data4, index=c("Year"), model="within")
summary(fixed3)
fixed4 <- plm(BTD_a ~ log(sdg13+1) + RDS + SIZE + LEV + ROA +
FOREIGN + ctrygrp, data=data3, index=c("Year"), model="within")
summary(fixed4)
fixed4 <- plm(CETR_3 ~ log(sdg13+1) + RDS + SIZE + LEV + ROA +
FOREIGN + ctrygrp, data=data3, index=c("Year"), model="within")
summary(fixed4)
fixed4 <- plm(CETR_3 ~ log(sdg13+1) + RDS + SIZE + LEV +
FOREIGN + ctrygrp, data=data3, index=c("Year"), model="within")
summary(fixed4)
data4 %>% filter(CETR_scaled > -20 & CETR_scaled < 20) %>%
ggplot(., aes(x=BTD_a, y=report, col = Sector)) +
geom_boxplot() +
facet_grid(. ~ ctrygrp)
data3 %>% filter(CETR_3 > -10) %>%
ggplot(., aes(x=BTD_a, y=Sector)) +
geom_boxplot()
#create new variables
data2 <- data1 %>% mutate(NOMINAL_TAX = PRETAX_INCOME*TAX_RATE*0.01, HS_delta = (CASH_TAX_PAID - NOMINAL_TAX),
MVA = ASSETS + (MARKET_VALUE - BOOK_VALUE_EQUITY),
delta_scaled = HS_delta/MVA,
BTD = (PRETAX_INCOME - INCOME_TAX/TAX_RATE*0.01)/ASSETS,
BTD_a =(PRETAX_INCOME*TAX_RATE*0.01 - INCOME_TAX)/ASSETS,
CETR_scaled = ((CETR_3*100-TAX_RATE)),
LEV = LTD/ASSETS,
RDS = RD/ASSETS,
SIZE = log(ASSETS),
FOREIGN = case_when(
PTI_FOREIGN > 1 ~ 1,
is.na(PTI_FOREIGN)  ~ 0,
TRUE ~ 0),
SHELTER = -4.30 + 6.63*BTD -1.72*LEV + 0.66*SIZE + 2.26*ROA + 1.62*FOREIGN + 1.56*RDS)
library(readr)
library(tidyverse)
library(readxl)
data <- read_excel("sample_report.xlsx",
sheet = "sample_long")
summary(data)
# import statutory tax rates from Tax Foundation.org
taxrates_81_21 <- read_excel("taxrates_81_21.xlsx")
tr <- taxrates_81_21 %>% filter(iso_2 %in% unique(data$Country) & year %in% c(2016:2020)) %>%
select(iso_2, country, year, rate)
unique(data$Country)
data1 <- data %>% left_join(.,tr, by = c("Year" = "year", "Country" = "iso_2"))
#create new variables
data2 <- data1 %>% mutate(NOMINAL_TAX = PRETAX_INCOME*TAX_RATE*0.01, HS_delta = (CASH_TAX_PAID - NOMINAL_TAX),
MVA = ASSETS + (MARKET_VALUE - BOOK_VALUE_EQUITY),
delta_scaled = HS_delta/MVA,
BTD = (PRETAX_INCOME - INCOME_TAX/TAX_RATE*0.01)/ASSETS,
BTD_a =(PRETAX_INCOME*TAX_RATE*0.01 - INCOME_TAX)/ASSETS,
CETR_scaled = ((CETR_3*100-TAX_RATE)),
LEV = LTD/ASSETS,
RDS = RD/ASSETS,
SIZE = log(ASSETS),
FOREIGN = case_when(
PTI_FOREIGN > 1 ~ 1,
is.na(PTI_FOREIGN)  ~ 0,
TRUE ~ 0),
SHELTER = -4.30 + 6.63*BTD -1.72*LEV + 0.66*SIZE + 2.26*ROA + 1.62*FOREIGN + 1.56*RDS)
load("C:/Users/HW van der Waal/projects/NLP-test/outdata.Rdata")
View(outdata)
out <- outdata %>% select(company, year, sdg01:int, doc_id)
df <- data2 %>% left_join(.,out, by = c("ISIN" = "company", "Year"= "year"))
write.csv(df, "df_table.txt")
#calculate Cash Effective Tax Rates en Henry-Sansing measures
# The H&S measure, indicated as ∆, is defined as the difference between cash taxes paid,
# adjusted for tax refunds receivable, and the product of its pre-tax book income
# and the statutory tax rate.
# The ∆ is then scaled by the market value of the firm assets to make the measure comparable across firms of different sectors. The market value of assets is the book value of assets plus the difference between market value of equity minus the book value of equity (Henry & Sansing, 2018).
#The market value of assets is the book value of assets plus the difference
#between market value of equity minus the book value of equity
unique(df$country)
table(df$country, df$ctrygrp)
which(df$ctrygrp=="EUR")
#create country groups based on country
df <- df %>% mutate(., ctrygrp = with(., case_when(
(Country %in% c("US", "JE")) ~ "USA",
(Country %in% c("SE", "DE", "FR", "CH", "NL", "BE", "DK", "ES", "IT", "FI")) ~ 'EUR',
(Country %in% c("KR", "JP", "TW")) ~ 'JKT',
(TRUE ~ "OTH")
)))
unique(df$ctrygrp)
# create report dummy variable - if no document, no report.
df <- df %>% mutate(report = as.factor(ifelse(is.na(doc_id), 1,0)))
df %>% filter(is.na(doc_id))
#make a boxplot of cash tax paid
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=CASH_TAX_PAID, col = ctrygrp)) +
geom_boxplot()
#make a boxplot of scaled Cash ETR
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=CETR_scaled, col = ctrygrp)) +
geom_boxplot()
#make a boxplot of  Cash ETR_3 >0
df %>% filter(Year %in% c(2016,2020) & CETR_3 >0) %>%
ggplot(., aes(x=report, y=CETR_3, col = ctrygrp)) +
geom_boxplot()
#make a boxplot of  BTD
df %>% filter(Year %in% c(2016,2020) & CETR_3 >0) %>%
ggplot(., aes(x=report, y=BTD, col = ctrygrp)) +
geom_boxplot()
#make a boxplot of  SHELTER
df %>% filter(Year %in% c(2016,2020) & CETR_3 >0) %>%
ggplot(., aes(x=report, y=log(SHELTER), col = ctrygrp)) +
geom_boxplot()
#make a boxplot of pre_tax income
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=PRETAX_INCOME, col = ctrygrp)) +
geom_boxplot()
#Unpaired Wilcoxon
# Subset weight data before treatment
report <- subset(df,  report == 1, delta_scaled,
drop = TRUE)
# subset weight data after treatment
noreport <- subset(df,  report == 0, delta_scaled,
drop = TRUE)
wilcox.test(report, noreport, alternative = "less")
#Unpaired Wilcoxon
# Subset weight data before treatment
report1 <- subset(df,  report == 1, CASH_TAX_PAID,
drop = TRUE)
# subset weight data after treatment
noreport1 <- subset(df,  report == 0, CASH_TAX_PAID,
drop = TRUE)
wilcox.test(report1, noreport1, alternative = "less")
#make a boxplot of delta-scaled versus report
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=delta_scaled, col = ctrygrp)) +
geom_boxplot()
df %>% group_by(report, ctrygrp) %>%
summarize(mean = mean(delta_scaled, na.rm = TRUE))
unique(df$Sector)
#make a boxplot of BTD versus report
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=BTD, col = ctrygrp)) +
geom_boxplot()
df %>% group_by(report, ctrygrp) %>%
summarize(mean = mean(delta_scaled, na.rm = TRUE))
x <- df$BTD[df$report==1]
y <- df$BTD[df$report==0]
mean(x, na.rm = TRUE)
mean(y, na.rm = TRUE)
length(x)
# run a t-test on the means
t.test(x, y = NULL,
alternative = c("greater"),
mu = 0, paired = FALSE, var.equal = FALSE,
conf.level = 0.95)
#make a boxplot of BTD versus report
mean(as.numeric(df$report, na.rm=TRUE))
df %>% filter(Year ==2020) %>%
select(report, BTD, ctrygrp, sdg)
df %>% group_by(Year) %>%
select(report, BTD, ctrygrp, sdg) %>%
summarize(n = n())
data3 <- df %>%
mutate(sdg = ifelse(is.na(sdg), 0, sdg)) %>%
select(sdg, BTD, BTD_a, ctrygrp, Year, Sector, sdg01:sdg16, report, country, delta_scaled,
CETR_3, CETR_scaled, ROA, LEV, RDS, FOREIGN, SIZE, SHELTER )
data3 %>%
ggplot(., aes(x=BTD, y=sdg, col = ctrygrp)) +
geom_point()
df %>% group_by(s, ctrygrp) %>%
summarize(mean = mean(BTD, na.rm = TRUE))
# plot BTD versus CETR_3
data3 %>%
ggplot(., aes(x=BTD, y=CETR_3, col = ctrygrp)) +
geom_point()
r1 <- lm(data3, formula = BTD ~ sdg07 + sdg13 + sdg16 + ctrygrp)
summary(r1)
r2 <- glm(report ~ BTD + ROA + RDS + SIZE + LEV + ctrygrp, family = binomial, data = data3)
summary(r2)
summary(data3$BTD)
r3 <- lm(BTD_a ~ sdg02 +sdg03 + sdg07 + sdg08 + sdg13 + sdg16 + RDS + ROA + SIZE + LEV +
FOREIGN + ctrygrp, data = data3)
summary(r3)
data3 %>%
ggplot(., aes(x=BTD_a, y=ROA/100, col = Sector)) +
geom_point()
data3 %>% filter(CETR_3 >0) %>%
ggplot(., aes(x=CETR_3, y=ROA/100, col = Sector)) +
geom_point()
# fit some PLM models on BTD
library(plm)
fixed1 <- plm(CETR_3 ~ sdg03 + sdg07 +sdg13 , data=data3, index=c("Year"), model="within")
summary(fixed1)
data4 <- data3 %>% filter(as.integer(report)==1) %>% mutate(SDG = log(sdg03 + sdg08 + sdg13 + sdg16 +1))
fixed2 <- plm(SDG ~ BTD + SIZE + FOREIGN, data=data4, index=c("Year"), model="within")
summary(fixed2)
fixed3 <- plm(sdg03 ~ BTD_a + Sector + country , data=data4, index=c("Year"), model="within")
summary(fixed3)
fixed4 <- plm(CETR_3 ~ log(sdg13+1) + RDS + SIZE + LEV +
FOREIGN + ctrygrp, data=data3, index=c("Year"), model="within")
summary(fixed4)
data4 %>% filter(CETR_scaled > -20 & CETR_scaled < 20) %>%
ggplot(., aes(x=BTD_a, y=report, col = Sector)) +
geom_boxplot() +
facet_grid(. ~ ctrygrp)
data3 %>% filter(CETR_3 > -10) %>%
ggplot(., aes(x=BTD_a, y=Sector)) +
geom_boxplot()
data3 %>% filter(CETR_3 > -10) %>%
ggplot(., aes(x=BTD_a, y=SIZE)) +
geom_point()
summary(data3)
data3 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=ROA, y=BTD_a, col = Sector)) +
geom_point()
data4 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=log(sdg13+1), y=CETR_scaled, col = Sector)) +
geom_point()
data4 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=ROA, y=CETR_scaled, col = Sector)) +
geom_point()
data4 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=ROA, y=BTD, col = Sector)) +
geom_point()
x <- df$BTD[df$report==1]
y <- df$BTD[df$report==0]
mean(x, na.rm = TRUE)
mean(y, na.rm = TRUE)
# run a t-test on the means
t.test(x, y = NULL,
alternative = c("greater"),
mu = 0, paired = FALSE, var.equal = FALSE,
conf.level = 0.95)
#make a boxplot of delta-scaled versus sector
df %>% filter(Year %in% c(2016,2020)) %>%
ggplot(., aes(x=report, y=delta_scaled, col = Sector)) +
geom_boxplot()
df %>% group_by(Sector, Year) %>%
summarize(mean_delta = mean(delta_scaled, na.rm=TRUE),
mean_ROA = mean(PRETAX_INCOME/ASSETS, na.rm =TRUE)) %>%
arrange(mean_delta) %>%
ggplot(aes(mean_ROA, mean_delta, col = Year)) +
geom_point()
#make a plot of sdg mentioning versus sector
# make a plot of delta scaled versus sdg mentioning frequency
df %>% filter(Year %in% c(2016,2020) & ctrygrp != "OTH") %>% ggplot(aes(Sector, log(sdg))) +
geom_boxplot() +
facet_grid(Year ~ ctrygrp) +
coord_flip()
#make a plot of sdg  versus sector
colors <- colorRampPalette(c("blue", "green", "yellow", "red"))(10)
df %>%  dplyr::select(Year, Sector, sdg01:sdg16, ctrygrp) %>%
filter(Year %in% c(2016,2020)) %>%
pivot_longer(cols = sdg01:sdg16,
names_to = "SDG",
values_to = "count") %>%
ggplot(aes(Sector, SDG)) +
geom_tile(aes(fill = log(count)), na.rm = TRUE) +
scale_fill_distiller(palette = "Spectral") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(axis.text.y=element_text(size=5)) +
coord_flip() +
facet_grid(ctrygrp ~ Year)
# make a plot of BTD versus sdg mentioning frequency
df %>% filter(Year %in% c(2016,2020) & ctrygrp != "OTH") %>% ggplot(aes(log(sdg+1), BTD, color = ctrygrp)) +
geom_point() +
facet_grid(. ~ Year)
df %>% filter(Year %in% c(2016,2020) & ctrygrp != "OTH") %>% ggplot(aes(report, BTD, col = ctrygrp)) +
geom_boxplot() +
facet_grid(. ~ Year)
df %>% filter(Year %in% c(2016,2020) & ctrygrp != "OTH") %>% ggplot(aes(BTD, log(sdg03+1), color = ctrygrp)) +
geom_point() +
facet_grid(. ~ Year)
#US environmentally sensitive industries, including oil and gas extraction, mining (except oil and gas), support activities for mining, utilities, food manufacturing, beverage and tobacco product manufacturing, paper manufacturing, petroleum and coal products manufacturing, chemical manufacturing, and fabricated metal product manufacturing.
# International Review of Accounting, Banking & Finance . Summer2012, Vol. 4 Issue 2, p61-99. 39p
#make a heatmap of BTD versus Sector and ctrygrp
df %>%  dplyr::select(Year, Sector, ctrygrp, BTD, sdg, report, gc, gri, int) %>%
filter(Year %in% c(2016,2020)) %>%
group_by(Sector, ctrygrp, report) %>% summarize(mBTD = mean(BTD, na.rm=TRUE), Year = Year, report = report) %>%
ggplot(aes(Sector, ctrygrp)) +
geom_tile(aes(fill = mBTD)) +
scale_fill_continuous(type = "viridis") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(axis.text.y=element_text(size=5)) +
coord_flip() +
facet_grid(report ~ Year)
fixed4 <- plm(CETR_3 ~ log(sdg13+1) + RDS + SIZE + LEV +
FOREIGN + ctrygrp, data=data3, index=c("Year"), model="within")
summary(fixed4)
data4 %>% filter(CETR_scaled > -20 & CETR_scaled < 20) %>%
ggplot(., aes(x=BTD_a, y=report, col = Sector)) +
geom_boxplot() +
facet_grid(. ~ ctrygrp)
data3 %>% filter(CETR_scaled > -20 & CETR_scaled < 20) %>%
ggplot(., aes(x=BTD_a, y=report, col = Sector)) +
geom_boxplot() +
facet_grid(. ~ ctrygrp)
fixed4 <- plm(CETR_3 ~ log(sdg+1) + RDS + SIZE + LEV +
FOREIGN + ctrygrp, data=data3, index=c("Year"), model="within")
summary(fixed4)
fixed3 <- plm(sdg03 ~ BTD + Sector + country , data=data4, index=c("Year"), model="within")
summary(fixed3)
fixed2 <- plm(SDG ~ BTD + SIZE + FOREIGN, data=data4, index=c("Year"), model="within")
summary(fixed2)
data3 %>% filter(CETR_3 > -10) %>%
ggplot(., aes(x=BTD, y=Sector)) +
geom_boxplot()
data3 %>% filter(CETR_3 > -10) %>%
ggplot(., aes(x=BTD, y=SIZE)) +
geom_point()
summary(data3)
data3 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=ROA, y=BTD_a, col = Sector)) +
geom_point()
data3 %>% filter(CETR_scaled > -50 & CETR_scaled < 50) %>%
ggplot(., aes(x=ROA, y=BTD, col = Sector)) +
geom_point()
