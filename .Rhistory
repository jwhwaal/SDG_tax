print(mycorrelations2$stars,quote=FALSE)
#correlation matrix for SDG narrow  dataset
mycorrelations2 <- df %>%
mutate(cetr = Winsorize(cetr, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, FOR_PERC, FTSE_ESG_sr,
log(sdg+1), sdg_total, sdg13, s_themes) %>%
psych::corr.test(.)
#correlation matrix for SDG narrow  dataset
mycorrelations2 <- df %>%
mutate(cetr = Winsorize(cetr, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, FOR_PERC, FTSE_ESG_sr,
sdg, sdg_total, sdg13, s_themes) %>%
psych::corr.test(.)
print(mycorrelations2$stars,quote=FALSE)
#correlation matrix for SDG narrow  dataset
mycorrelations2 <- df %>%
mutate(cetr = Winsorize(cetr, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, FOR_PERC, FTSE_ESG_sr,
sdg, sdg_total, sdg13, s_themes) %>%
mutate(sdg = log(sdg+1), s_themes = log(s_themes+1), sdg_total=log(sdg_total+1),
sdg13 = log(sdg13+1), SDG = as.integer(SDG), GC = as.integer(GC),
GRI = as.integer(GRI), INT = as.integer(INT), report = as.integer(report)) %>%
psych::corr.test(.)
#correlation matrix for SDG narrow  dataset
mycorrelations2 <- df %>%
mutate(cetr = Winsorize(cetr, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, FOR_PERC, FTSE_ESG_sr,
sdg, sdg_total, sdg13, s_themes, SDG, GC, GRI, INT, report) %>%
mutate(sdg = log(sdg+1), s_themes = log(s_themes+1), sdg_total=log(sdg_total+1),
sdg13 = log(sdg13+1), SDG = as.integer(SDG), GC = as.integer(GC),
GRI = as.integer(GRI), INT = as.integer(INT), report = as.integer(report)) %>%
psych::corr.test(.)
print(mycorrelations2$stars,quote=FALSE)
#df2 is the data file voor de 2 jaren met extra berekende variabelen
df2 <- longlist_3 %>%
select(-Column1) %>%
filter(year == 2016 | year == 2020) %>%
mutate(
LEV = LTD/ASSETS,
cetr = CTP/PTI,
RDS = RD/ASSETS, #R&D expenses scaled by assets
SIZE = log(ASSETS),
FOREIGN = case_when(
PTI_FOREIGN > 0 ~ 1, #foreign pre-tax income
is.na(PTI_FOREIGN)  ~ 0,
TRUE ~ 0),
FOR_PERC = case_when(
PTI_FOREIGN > 0 ~ PTI_FOREIGN/PTI, #foreign pre-tax income
is.na(PTI_FOREIGN)  ~ 0,
TRUE ~ 0),
BTD = (PTI*str*0.01-CTP)/ASSETS #book-tax difference
)
# # Load the SDG scores per SDG e.o. per ISIN from NLP-test
load("C:/Users/HW van der Waal/projects/NLP-test/outdata.Rdata")
out_temp <- outdata %>%
mutate(report = ifelse(is.na(doc_id), 0, 1)) %>%
group_by(company, year) %>%
summarize(sdg01 = sum(sdg01),
sdg02 = sum(sdg02),
sdg03 = sum(sdg03),
sdg04 = sum(sdg04),
sdg05 = sum(sdg05),
sdg06 = sum(sdg06),
sdg07 = sum(sdg07),
sdg08 = sum(sdg08),
sdg09 = sum(sdg09),
sdg10 = sum(sdg10),
sdg11 = sum(sdg11),
sdg12 = sum(sdg12),
sdg13 = sum(sdg13),
sdg14 = sum(sdg14),
sdg15 = sum(sdg15),
sdg16 = sum(sdg16),
sdg17 = sum(sgd17),
sdg = sum(sdg),
gc = sum(gc),
gri = sum(gri),
int = sum(int),
report = sum(report),
sdg_total = sum(sdg01:sdg17))
out_temp <- out_temp %>% rowwise() %>%
mutate(s_themes = sum(c_across(sdg01:sdg17)>0))
#check if every company per year is only mentioned once
out_temp %>% group_by(company, year) %>% summarize(n = n()) %>%
arrange(desc(n))
# join de SDG-data op de financiÃ«le data
df <- df2 %>% left_join(.,out_temp, by = c("ISIN" = "company", "year"= "year"))
df <- df %>% mutate(., ctrygrp = with(., case_when(
(Country %in% c("US", "JE")) ~ "USA",
(Country %in% c("SE", "DE", "FR", "CH", "NL", "BE", "DK", "ES", "IT", "FI")) ~ 'EUR',
(Country %in% c("KR", "JP", "TW")) ~ 'JKT',
(TRUE ~ "OTH")
)),
mutate(., across(sdg01:int, ~ifelse(is.na(.x),0,.x)))) %>%
mutate(report = ifelse(is.na(report),0, 1),
SDG = as.factor(case_when(
sdg > 0 ~ 1,
is.na(sdg)  ~ 0,
TRUE ~ 0)),
report = as.factor(case_when(
report > 0 ~ 1,
is.na(report)  ~ 0,
TRUE ~ 0)),
GC = as.factor(ifelse(gc > 0, 1, 0)),
GRI = as.factor(ifelse(gri > 0, 1, 0)),
INT = as.factor(ifelse(int> 0, 1, 0)),
cetr = CTP/PTI,
sdg_total = coalesce(sdg_total,0), #replaces NA's by 0 in this case
s_themes = coalesce(s_themes,0)
)
df$SDG <- recode(df$SDG, "1" = "SDG", "0" = "noSDG")
df$report <- recode(df$report, "1" = "report", "0" = "no report")
# and write the final data frame disk for future reference
write.csv(df, "df_tax.txt")
save(df, file = "df_tax.Rdata" )
# and write the final data frame disk for future reference
write.csv(df, "df_table.txt")
#=============================== DATA EXPLORATION SECTION ============================
# Summary statistics table
library(vtable)
# Make a summary statistics table
library(vtable)
var.labs1 <- data.frame(var = c("SIZE",
"PTI",
"CTP",
"ROA",
"performance",
"LEV",
"cetr",
"cetr_5",
"cetr_5_s",
"BTD",
"str",
"FOREIGN",
"FOR_PERC",
"FTSE_ESG_sr"),
labels = c("Size (log(Assets))",
"Pre-tax Income (PTI)",
"Cash Taxes Paid (CTP)",
"Return on Assets % (ROA)",
"Relative Performance (performance)",
"Long Term Debt / Assets (LTD)",
"Cash Effective Tax Rate (CETR)",
"5-year CETR (cetr_5)",
"scaled 5-year CETR (cetr_5_s) ",
"Book-Tax Difference / Assets (BTD)",
"Statutory Tax Rate (str)",
"Foreign Pre-tax Income Dummy (FOREIGN)",
"Foreign Pre-tax Income Percentage (FOR_PERC)",
"FTSE Russel ESG rating (FTSE_ESG_sr)"
))
df1 %>%  sumtable(., vars = var.labs1$var, labels = var.labs1, out = "csv", file = "summary1.csv")
var.labs2 <- data.frame(var = c("sdg01",
"sdg02",
"sdg03",
"sdg04",
"sdg05",
"sdg06",
"sdg07",
"sdg08",
"sdg09",
"sdg10",
"sdg11",
"sdg12",
"sdg13",
"sdg14",
"sdg15",
"sdg16",
"sdg17",
"sdg",
"sdg_total",
"s_themes",
"SDG",
"GC",
"GRI",
"INT",
"report" ),
labels = c("SDG  1 No Pverty (sdg01)",
"SDG  2 Zero Hunger (sdg02)",
"SDG  3 Good Health & Wellbeing (sdg03)",
"SDG  4 Quality Education (sdg04)",
"SDG  5 Gender Equality (sdg05)",
"SDG  6 Clean Water & Sanitation (sdg06)",
"SDG  7 Affordable & Clean Energy (sdg07)",
"SDG  8 Decent Work & Econ. Growth (sdg08)",
"SDG  9 Industry, Innovation & Infrastructure (sdg09)",
"SDG 10 Reduced Inequalities (sdg10)",
"SDG 11 Sustainable Cities & Communities (sdg11)",
"SDG 12 Responsible Consumption & Production (sdg12)",
"SDG 13 Climate Action (sdg13)",
"SDG 14 Life Below Water (sdg14)",
"SDG 15 Life on Land (sdg15)",
"SDG 16 Peace, Justice & Strong Institutions (sdg16)",
"SDG 17 Partnership for the Goals (sdg17)",
"SDG & 2030 Agenda mentioning (sdg)",
"Total SDG1 - SDG 17 mentioning (sdg_total)",
"SDG Themes (number) (s_themes)",
"SDG mentioning dummy (SDG)",
"Global Compact  dummy (GC)",
"Global Reporting Initiative GRI dummy (GRI)",
"Integrated Reporting IIRC dummy (INT)",
"Sustainability report incl. integrated dummy (report)"
))
df %>%  sumtable(., vars = var.labs2$var, labels = var.labs2, out = "csv", file = "summary2.csv")
#make a boxplot of cash tax paid versus ESG-rating
df1 %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE)) %>%
ggplot(aes(cetr_w, FTSE_ESG_sr, col = ctrygrp)) +
geom_point() +
xlab( "Cash Effective Tax Rate") +
ylab("ESG-rating") +
labs(col = "Country Group")
#make a boxplot of CETR_5 versus ESG-rating and reporting
df %>% mutate(cetr_w = Winsorize(cetr_5_s, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
ggplot(aes(cetr_w, FTSE_ESG_sr, colour = ctrygrp)) +
geom_point() +
geom_density_2d() +
xlab( "5-year Cash Effective Tax Rate scaled to Statutory Tax Rate") +
ylab("ESG-rating") +
labs(colour = "Country Group")
df1 %>%
ggplot(aes(BTD, FTSE_ESG_sr)) +
geom_point() +
facet_wrap(. ~ctrygrp) +
xlab( "Book-Tax Difference / Assets") +
ylab("ESG-rating")
df %>%
ggplot(aes(FTSE_ESG_sr, log(sdg_total+1))) +
geom_point() +
facet_wrap(. ~ctrygrp) +
xlab( "ESG-rating") +
ylab("SDG-total (log scale)") +
geom_smooth(method = lm, formula = y ~ x, se = TRUE)
library(corrplot)
source("http://www.sthda.com/upload/rquery_cormat.r")
#correlation matrix DF1
cor.mat <- df1 %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, performance, FOR_PERC, FTSE_ESG_sr) %>%
drop_na() %>%
cor() %>%
round(.,2)
print(cor.mat)
library(psych)
#correlation matrix for full dataset
mycorrelations1 <- df1 %>%
mutate(cetr = Winsorize(cetr, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, performance, FOR_PERC, FTSE_ESG_sr) %>%
psych::corr.test(.)
df1 %>%
mutate(cetr = Winsorize(cetr, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, performance, FOR_PERC, FTSE_ESG_sr) %>% lowerCor
print(mycorrelations1$stars,quote=FALSE)
cormat <- as.data.frame(mycorrelations1$stars)
write_csv(as.data.frame(mycorrelations1$stars), file = "cormat1.csv")
#correlation matrix for SDG narrow  dataset
mycorrelations2 <- df %>%
mutate(cetr = Winsorize(cetr, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, FOR_PERC, FTSE_ESG_sr,
sdg, sdg_total, sdg13, s_themes, SDG, GC, GRI, INT, report) %>%
mutate(sdg = log(sdg+1), s_themes = log(s_themes+1), sdg_total=log(sdg_total+1),
sdg13 = log(sdg13+1), SDG = as.integer(SDG), GC = as.integer(GC),
GRI = as.integer(GRI), INT = as.integer(INT), report = as.integer(report)) %>%
psych::corr.test(.)
print(mycorrelations2$stars,quote=FALSE)
cormat <- as.data.frame(mycorrelations2$stars)
write_csv(as.data.frame(mycorrelations2$stars), file = "cormat1.csv")
#correlation matrix for SDG narrow  dataset
mycorrelations2 <- df %>%
mutate(cetr = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, FOR_PERC, FTSE_ESG_sr,
sdg, sdg_total, sdg13, s_themes, SDG, GC, GRI, INT, report) %>%
mutate(sdg = log(sdg+1), s_themes = log(s_themes+1), sdg_total=log(sdg_total+1),
sdg13 = log(sdg13+1), SDG = as.integer(SDG), GC = as.integer(GC),
GRI = as.integer(GRI), INT = as.integer(INT), report = as.integer(report)) %>%
psych::corr.test(.)
print(mycorrelations2$stars,quote=FALSE)
cormat <- as.data.frame(mycorrelations2$stars)
write_csv(as.data.frame(mycorrelations2$stars), file = "cormat1.csv")
write_csv(as.data.frame(mycorrelations1$stars), file = "cormat1.csv")
write_csv(as.data.frame(mycorrelations2$stars), file = "cormat2.csv")
#check if data frames are balanced
df %>% is.pbalanced(index =c("year", "ISIN"))
#=========================================== REGRESSIONS =======================
# fit some PLM models
library(plm)
#check if data frames are balanced
df %>% is.pbalanced(index =c("year", "ISIN"))
df1 %>% is.pbalanced(index =c("year", "ISIN"))
#first stage: regression of CETR versus ESG-performance on DF1 (3000 observations)
form1 <- cetr_w ~ SIZE + FTSE_ESG_sr + ROA + performance + FOR_PERC + ctrygrp + factor(year)
#winsorize data
df_w <- df %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
#SOME REGRESSIONS
ols1 <- lm(form1, data = df_w)
#first stage: regression of CETR versus ESG-performance on DF1 (3000 observations)
form1 <- cetr_w ~ SIZE + FTSE_ESG_sr + ROA + FOR_PERC + ctrygrp + factor(year)
#winsorize data
df_w <- df %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
#SOME REGRESSIONS
ols1 <- lm(form1, data = df_w)
summary(ols1)
#first stage: regression of CETR versus ESG-performance on DF1 (3000 observations)
form1 <- cetr_w ~ SIZE + FTSE_ESG_sr + ROA + performance + LTD + LEV + FOR_PERC + FOREIGN + ctrygrp + factor(year)
#winsorize data
df_w <- df1 %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
#winsorize data
df1_w <- df1 %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
#SOME REGRESSIONS
ols1 <- lm(form1, data = df1_w)
summary(ols1)
#correlation matrix for full dataset
mycorrelations1 <- df1 %>%
mutate(cetr = Winsorize(cetr, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, LEV, LTD, performance, FOR_PERC, FTSE_ESG_sr) %>%
psych::corr.test(.)
df1 %>%
mutate(cetr = Winsorize(cetr, probs = c(0.01, 0.99), na.rm = TRUE)) %>%
select(cetr_5_s, cetr_5, cetr, BTD, SIZE, ROA, performance, FOR_PERC, FTSE_ESG_sr) %>% lowerCor
print(mycorrelations1$stars,quote=FALSE)
cormat <- as.data.frame(mycorrelations1$stars)
write_csv(as.data.frame(mycorrelations1$stars), file = "cormat1.csv")
#first stage: regression of CETR versus ESG-performance on DF1 (3000 observations)
form1 <- cetr_5_s ~ SIZE + FTSE_ESG_sr + ROA + performance + LTD + LEV + FOR_PERC + FOREIGN + ctrygrp + factor(year)
#winsorize data
df1_w <- df1 %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
#SOME REGRESSIONS
model.pooling <- lm(form1, data = df1_w)
summary(model.pooling)
#SOME REGRESSIONS
model.pooling <- lm(form1, data = df1_w)
summary(model.pooling)
#winsorize data
df1_w <- df1 %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
#SOME REGRESSIONS
model.pooling <- lm(form1, data = df1_w)
summary(model.pooling)
#first stage: regression of CETR versus ESG-performance on DF1 (3000 observations)
form1 <- cetr_w ~ SIZE + FTSE_ESG_sr + ROA + performance + LTD + LEV + FOR_PERC + FOREIGN + ctrygrp + factor(year)
#winsorize data
df1_w <- df1 %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
#SOME REGRESSIONS
model.pooling <- lm(form1, data = df1_w)
summary(model.pooling)
model.pool <- plm(form1, data=df_w, model="pooling", index=c("year"), random.method = "walhus")
summary(model.pool)
#do a lagged regression
library(dynlm)
#do a lagged regression
library(dynlm)
model.lag <- dynlm(cetr_w ~ SIZE + FTSE_ESG_sr + ROA + LTD + LEV + FOR_PERC + FOREIGN + ctrygrp +
L(performance,1:5) + L(cetr,1:5) + ctrygrp + factor(year),
data = df1_w)
model.lag <- dynlm(cetr_w ~ SIZE + FTSE_ESG_sr + L(performance,1:5) + L(cetr,1:5) + ctrygrp + factor(year),
data = df1_w)
model.lag <- dynlm(cetr_w ~ SIZE + FTSE_ESG_sr + L(cetr,1:5) + ctrygrp + factor(year),
data = df1_w)
model.lag <- dynlm(cetr_w ~ SIZE + FTSE_ESG_sr + L(cetr_w,1:5) + ctrygrp + factor(year),
data = df1_w)
#winsorize data
df1_w <- df1 %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
model.lag <- dynlm(cetr_w ~  L(cetr_w,1:5), data = df1_w)
?dynlm
model.lag <- dynlm(cetr_w ~  L(cetr_w,1), data = df1_w)
summary(model.lag)
model.lag <- dynlm(cetr_w ~  L(cetr_w,1:3), data = df1_w)
?as.ts
?as.zoo
df_w_ts <- as.zoo(df_w)
model.lag <- dynlm(cetr_w ~  L(cetr_w,1:3), data = df1_w_ts)
df1_w_ts <- as.zoo(df_w)
model.lag <- dynlm(cetr_w ~  L(cetr_w,1:3), data = df1_w_ts)
df1_w_ts <- ts(df1_w ,frequency=1,start=c(2011,1))
model.random <- plm(form1, data=df_w, model="random", index=c("year"), random.method = "walhus")
summary(model.random)
?plm
model.random <- plm(form1, data=df_w, model="random", effect = "individual",
index=c("year"), random.method = "walhus")
summary(model.random)
model.random <- plm(form1, data=df_w, model="random", effect = "twoways",
index=c("year"), random.method = "walhus")
summary(model.random)
model.random <- plm(form1, data=df_w, model="random", effect = "time",
index=c("year"), random.method = "walhus")
summary(model.random)
form2 <- FTSE_ESG_sr ~ log(sdg+1) + log(sdg01+1) + log(sdg02+1) + log(sdg03+1) + log(sdg04+1) +
log(sdg05+1) + log(sdg06+1) + log(sdg07+1) + log(sdg08+1) +
+log(sdg09+1) + log(sdg10+1) + log(sdg11+1) + log(sdg12+1) +
log(sdg13+1) + log(sdg14+1) + log(sdg15+1) + log(sdg16+1) +
log(sdg17+1) + log(sdg_total+1) + log(s_themes+1) + factor(report) + + factor(SDG) + factor(GRI) +
factor(GC) + factor(INT) + ctrygrp +
SIZE + factor(year)
form2 <- FTSE_ESG_sr ~ log(sdg+1) + log(sdg01+1) + log(sdg02+1) + log(sdg03+1) + log(sdg04+1) +
log(sdg05+1) + log(sdg06+1) + log(sdg07+1) + log(sdg08+1) +
+log(sdg09+1) + log(sdg10+1) + log(sdg11+1) + log(sdg12+1) +
log(sdg13+1) + log(sdg14+1) + log(sdg15+1) + log(sdg16+1) +
log(sdg17+1) + log(sdg_total+1) + log(s_themes+1) + factor(report) + + factor(SDG) + factor(GRI) +
factor(GC) + factor(INT) + ctrygrp +
SIZE + factor(year)
model.sdg.pooling <- plm(form1, data = df)
model.sdg.pooling <- plm(form2, data = df)
summary(model.sdg.pooling)
model.sdg.pooling <- lm(form2, data = df)
summary(model.sdg.pooling)
form2 <- FTSE_ESG_sr ~ log(sdg+1) + log(sdg01+1) + log(sdg02+1) + log(sdg03+1) + log(sdg04+1) +
log(sdg05+1) + log(sdg06+1) + log(sdg07+1) + log(sdg08+1) +
+log(sdg09+1) + log(sdg10+1) + log(sdg11+1) + log(sdg12+1) +
log(sdg13+1) + log(sdg14+1) + log(sdg15+1) + log(sdg16+1) +
log(sdg17+1) + log(sdg_total+1) + log(s_themes+1) + factor(report) + factor(SDG) + factor(GRI) +
factor(GC) + factor(INT) + ctrygrp +
SIZE + factor(year)
model.sdg.pooling <- lm(form2, data = df)
summary(model.sdg.pooling)
form2 <- FTSE_ESG_sr ~ log(sdg_total+1) + log(s_themes+1) + factor(report) + factor(SDG) + factor(GRI) +
factor(GC) + factor(INT) + ctrygrp +
SIZE + factor(year)
model.sdg.pooling <- lm(form2, data = df)
summary(model.sdg.pooling)
model.sdg<- lm(form2, data = df)
summary(model.sdg)
form2 <- FTSE_ESG_sr ~ log(sdg_total+1) + ctrygrp +
SIZE + factor(year)
model.sdg<- lm(form2, data = df)
form2 <- FTSE_ESG_sr ~ log(sdg_total+1) + ctrygrp
model.sdg<- lm(form2, data = df)
summary(model.sdg)
form2 <- FTSE_ESG_sr ~ log(sdg_total+1) + ctrygrp + factor(year)
model.sdg<- lm(form2, data = df)
summary(model.sdg)
form2 <- FTSE_ESG_sr ~ log(sdg_total+1) + ctrygrp + log(sdg+1) + factor(year)
model.sdg<- lm(form2, data = df)
summary(model.sdg)
form2 <- FTSE_ESG_sr ~ log(sdg+1) + log(sdg_total+1) + ctrygrp + SIZE + factor(year)
model.sdg<- lm(form2, data = df)
summary(model.sdg)
form2 <- FTSE_ESG_sr ~ log(sdg+1) + log(sdg_total+1) + log(s_themes+1) +  ctrygrp + SIZE + factor(year)
model.sdg<- lm(form2, data = df)
summary(model.sdg)
form2 <- FTSE_ESG_sr ~ log(sdg+1) + log(sdg_total+1) + log(s_themes+1) +  ctrygrp +
ROA + SIZE + factor(year)
model.sdg<- lm(form2, data = df)
summary(model.sdg)
form2 <- FTSE_ESG_sr ~ log(sdg+1) + log(sdg_total+1) + log(s_themes+1) +  ctrygrp +
cetr + SIZE + factor(year)
model.sdg<- lm(form2, data = df)
summary(model.sdg)
df_w <- df %>%
mutate(cetr = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
form3 <- cetr ~ log(sdg+1) + log(sdg_total+1) + log(s_themes+1) +  ctrygrp +
SIZE + factor(year)
model.sdg2<- lm(form3, data = df_w)
summary(model.sdg2)
summary(model.sdg3)
form3 <- cetr ~ log(sdg+1) + log(sdg_total+1) + log(s_themes+1) +  ctrygrp +
SIZE + SDG + GC + GRI + INT + report + factor(year)
model.sdg2<- lm(form3, data = df_w)
summary(model.sdg2)
form3 <- cetr_5_s ~ log(sdg+1) + log(sdg_total+1) + log(s_themes+1) +  ctrygrp +
SIZE + SDG + GC + GRI + INT + report + factor(year)
model.sdg2<- lm(form3, data = df_w)
summary(model.sdg2)
form3 <- cetr_5 ~ log(sdg+1) + log(sdg_total+1) + log(s_themes+1) +  ctrygrp +
SIZE + SDG + GC + GRI + INT + report + factor(year)
model.sdg2<- lm(form3, data = df_w)
summary(model.sdg2)
form3 <- BTD ~ log(sdg+1) + log(sdg_total+1) + log(s_themes+1) +  ctrygrp +
SIZE + SDG + GC + GRI + INT + report + factor(year)
model.sdg2<- lm(form3, data = df_w)
summary(model.sdg2)
df1 %>%
ggplot(aes(BTD, log(sdg_total+1))) +
geom_point() +
facet_wrap(. ~ctrygrp) +
xlab( "Book-Tax Difference / Assets") +
ylab("SDG_total (log-scale)")
df %>%
ggplot(aes(BTD, log(sdg_total+1))) +
geom_point() +
facet_wrap(. ~ctrygrp) +
xlab( "Book-Tax Difference / Assets") +
ylab("SDG_total (log-scale)")
df %>%
ggplot(aes(BTD, log(s_themes+1))) +
geom_point() +
facet_wrap(. ~ctrygrp) +
xlab( "Book-Tax Difference / Assets") +
ylab("SDG_total (log-scale)")
sdg_total
df %>%
ggplot(aes(BTD, log(sdg_total+1))) +
geom_point() +
facet_wrap(. ~ctrygrp) +
xlab( "Book-Tax Difference / Assets") +
ylab("SDG_total (log-scale)")
df %>%
ggplot(aes(BTD, log(sdg+1))) +
geom_point() +
facet_wrap(. ~ctrygrp) +
xlab( "Book-Tax Difference / Assets") +
ylab("SDG_total (log-scale)")
#first stage: regression of CETR versus ESG-performance on DF1 (3000 observations)
form1 <- BTD ~ SIZE + FTSE_ESG_sr + ROA + performance + LTD + LEV + FOR_PERC + FOREIGN + ctrygrp + factor(year)
#winsorize data
df1_w <- df1 %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
#SOME REGRESSIONS
model.pooling <- lm(form1, data = df1_w)
summary(model.pooling)
#first stage: regression of CETR versus ESG-performance on DF1 (3000 observations)
form1 <- cetr_w ~ SIZE + FTSE_ESG_sr + ROA + performance + LTD + LEV + FOR_PERC + FOREIGN + ctrygrp + factor(year)
#winsorize data
df1_w <- df1 %>% mutate(cetr_w = Winsorize(cetr, minval = 0, maxval = 1, na.rm = TRUE))
#SOME REGRESSIONS
model.pooling <- lm(form1, data = df1_w)
summary(model.pooling)
