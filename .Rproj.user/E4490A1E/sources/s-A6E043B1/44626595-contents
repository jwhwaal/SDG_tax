library(readxl)
library(tidyverse)
living_wage <- read_excel("C:/Users/HW van der Waal/Downloads/living_wage.xlsx", 
                          sheet = "Estadisticas")

living_wage <- rename(living_wage, mms = 'minimum monthly salary', as = 'average salary', 
                      lw = 'living wage', productivity = 'Productivity (Box/ha)',
                      worker_rate = 'worker/ha')
data <- living_wage %>% mutate(lw_doos = ifelse(as < lw, worker_rate/productivity*12*(lw-as)*100, 0))

data_long <- data %>% select(Country, mms, as, lw, productivity, worker_rate, lw_doos) %>%
  pivot_longer(., cols = -Country, names_to = "parameter", values_to = "value")

data_long %>% filter(parameter == "lw_doos") %>% ggplot(aes(x= Country, y = value)) +
  geom_col() +
  labs(x = "Response (on a 1 to 5 scale)", y = "Number of respondents")
                               
data_long %>%  filter(parameter == "lw_doos") %>% 
  ggplot(aes(x= parameter, y = value, fill = Country)) +
  geom_col(position = "dodge") +
  labs(x = "parameters", y = "value")
